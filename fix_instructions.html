<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fix Client Addresses Table</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            padding: 2rem;
        }
        .container {
            max-width: 800px;
        }
        .card {
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
        }
        .card-header {
            background-color: #111827;
            color: white;
            border-radius: 10px 10px 0 0;
            padding: 1rem 1.5rem;
        }
        .card-body {
            padding: 1.5rem;
        }
        pre {
            background-color: #f8f9fa;
            padding: 1rem;
            border-radius: 5px;
            overflow-x: auto;
        }
        .btn-primary {
            background-color: #f59e0b;
            border-color: #f59e0b;
            color: #111827;
        }
        .btn-primary:hover {
            background-color: #d97706;
            border-color: #d97706;
            color: #111827;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h1><i class="bi bi-tools me-2"></i> Fix Client Addresses Table</h1>
            </div>
            <div class="card-body">
                <div class="alert alert-warning">
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                    <strong>Issue Detected:</strong> The client_addresses table is missing or has missing columns.
                </div>

                <h2>How to Fix</h2>
                <p>Follow these steps to fix the client_addresses table:</p>

                <ol class="mb-4">
                    <li>Open phpMyAdmin by going to <a href="http://localhost/phpmyadmin/" target="_blank">http://localhost/phpmyadmin/</a></li>
                    <li>Select the "brew_and_bake" database from the left sidebar</li>
                    <li>Click on the "SQL" tab at the top</li>
                    <li>Copy and paste the SQL code below into the SQL query box:</li>
                </ol>

                <pre><code>-- Fix client_addresses table
USE brew_and_bake;

-- Check if client_addresses table exists
CREATE TABLE IF NOT EXISTS client_addresses (
    id INT NOT NULL AUTO_INCREMENT,
    client_id INT NOT NULL,
    address TEXT NOT NULL,
    city VARCHAR(100) NOT NULL DEFAULT 'Manila',
    state VARCHAR(100) NULL,
    postal_code VARCHAR(20) NOT NULL DEFAULT '1000',
    country VARCHAR(100) NOT NULL DEFAULT 'Philippines',
    phone VARCHAR(20) NULL,
    is_default BOOLEAN NOT NULL DEFAULT 1,
    created_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (id),
    FOREIGN KEY (client_id) REFERENCES users(id) ON DELETE CASCADE
);

-- Add phone column if it doesn't exist
ALTER TABLE client_addresses ADD COLUMN IF NOT EXISTS phone VARCHAR(20) NULL AFTER country;

-- Add is_default column if it doesn't exist
ALTER TABLE client_addresses ADD COLUMN IF NOT EXISTS is_default BOOLEAN NOT NULL DEFAULT 1 AFTER phone;

-- Make sure all existing records have is_default set to 1
UPDATE client_addresses SET is_default = 1 WHERE is_default IS NULL;</code></pre>

                <p class="mt-4">After running the SQL code, the client_addresses table will be created with all the necessary columns.</p>

                <div class="mt-4">
                    <a href="templates/client/profile.php" class="btn btn-primary">
                        <i class="bi bi-person me-2"></i> Go to Profile Page
                    </a>
                    <a href="fix_client_addresses.sql" class="btn btn-outline-secondary ms-2" download>
                        <i class="bi bi-download me-2"></i> Download SQL Script
                    </a>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
